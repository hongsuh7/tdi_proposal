group_by(month_received, year_received, fado_type) %>%
count() %>%
pivot_wider(names_from = fado_type, values_from = n) %>%
rename(abuse = `Abuse of Authority`,
rude = Discourtesy,
force = Force) %>%
mutate_at(c("abuse","rude","force"), ~replace(., is.na(.), 0)) %>%
inner_join(henry_payroll, by = 'year_received') %>%
mutate(adjusted_pay = henry_payroll$total_pay[year_received - 2013] +
(month_received-1)/12 * (henry_payroll$total_pay[year_received - 2012] - henry_payroll$total_pay[year_received - 2013])) %>%
mutate(allegations = abuse + rude + force)
henry_daverin
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste(
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste(
"Force: ", abuse, "\n",
"Abuse of Authority: ", force, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force,
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force,
"Abuse of Authority: "
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", henry_daverin$force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", henry_daverin$force, "\n",
"Abuse of Authority: ", henry_daverin$abuse, "\n",
"Discourtesy: ", rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", henry_daverin$force, "\n",
"Abuse of Authority: ", henry_daverin$abuse, "\n",
"Discourtesy: ", henry_daverin$rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", henry_daverin$force, "\n",
"Abuse of Authority: ", henry_daverin$abuse, "\n",
"Discourtesy: ", henry_daverin$rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay), size = allegations) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", henry_daverin$force, "\n",
"Abuse of Authority: ", henry_daverin$abuse, "\n",
"Discourtesy: ", henry_daverin$rude
)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay), size = allegations) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
henry_daverin$abuse
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = "a"), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations, data = henry_daverin), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
rlang::last_error()
names(henry_daverin)
paste0("a","b")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0("a",allegations)), alpha = 0.5, color = 'red') +
geom_point(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0("a", allegations)), alpha = 0.5, color = 'red')
ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0("a", allegations)), alpha = 0.5, color = 'red') + geom_line()
ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0("a", allegations)), alpha = 0.5, color = 'red') + geom_point()
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0("a", allegations)), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations))
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data=minhchau_payroll, aes(x = Fiscal.Year, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(data=henry_payroll, aes(x = year_received, y = total_pay), color = 'blue')
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations))
ggplotly(g, tooltip = "text")
henry_daverin
minhchau_payroll
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(total_pay)
minhchau_payroll
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(year_received)
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(Fiscal.Year)
minhchau_payroll
henry_daverin$minhchau_adjusted_pay <- 0
for i in 1:5{}
for(i in 1:5){}
for(i in 1:5){print("a")}
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received - 2013
month <- henry_daverin$month_received
henry_daverin$minhchau_adjusted_pay[i] <- minhchau_payroll$total_pay[year] + (month-1)/12 * (minhchau_payroll$total_pay[year+1] - minhchau_payroll$total_pay[year])
}
warnings()
month <- henry_daverin$month_received[i]
henry_daverin$minhchau_adjusted_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
month <- henry_daverin$month_received[i]
henry_daverin$minhchau_adjusted_pay[i] <- minhchau_payroll$total_pay[year] + (month-1)/12 * (minhchau_payroll$total_pay[year+1] - minhchau_payroll$total_pay[year])
}
henry_daverin$minhchau_adjusted_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
henry_daverin$minhchau_total_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = minhchau_total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
henry_daverin$minhchau_total_pay
minhchau_payroll
henry_daverin
minhchau_payroll[[-1]]
minhchau_payroll[-1]
henry_daverin$minhchau_total_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
henry_daverin
henry_daverin[15] <- c(0,2019,0,0,0,minhchau_payroll[[6]],henry_payroll[[6]])
henry_daverin[[15]] <- c(0,2019,0,0,0,minhchau_payroll[[6]],henry_payroll[[6]])
henry_daverin <- rbind(henry_daverin, data.frame(c(0,2019,0,0,0,minhchau_payroll[[6]],henry_payroll[[6]])))
henry_payroll
minhchau_payroll
henry_daverin <- police[police$unique_mos_id == 11185,]
henry_payroll <- payroll %>%
filter(Last.Name == "DAVERIN" | Last.Name == "Daverin") %>%
filter(First.Name == "HENRY") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay)
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(Fiscal.Year)
henry_payroll <- henry_payroll %>%
rename(year_received = Fiscal.Year) %>%
select(year_received, total_pay) %>%
arrange(year_received)
henry_daverin <- henry_daverin %>%
group_by(month_received, year_received, fado_type) %>%
count() %>%
pivot_wider(names_from = fado_type, values_from = n) %>%
rename(abuse = `Abuse of Authority`,
rude = Discourtesy,
force = Force) %>%
mutate_at(c("abuse","rude","force"), ~replace(., is.na(.), 0)) %>%
inner_join(henry_payroll, by = 'year_received') %>%
mutate(adjusted_pay = henry_payroll$total_pay[year_received - 2013] +
(month_received-1)/12 * (henry_payroll$total_pay[year_received - 2012] - henry_payroll$total_pay[year_received - 2013])) %>%
mutate(allegations = abuse + rude + force)
henry_daverin$minhchau_total_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
henry_daverin
henry_daverin[[15]] <- c(0,2019,0,0,0, henry_payroll[[6]],0,0,minhchau_payroll[[6]])
henry_daverin <- rbind(henry_daverin, data.frame(c(0,2019,0,0,0, henry_payroll[[6]],0,0,minhchau_payroll[[6]]))
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = minhchau_total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
henry_daverin
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(data = minhchau_payroll, aes(x = year_received, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
henry_daverin$minhchau_total_pay <- 0
henry_daverin$minhchau_total_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
henry_daverin <- rbind(henry_daverin, data.frame(c(0,2019,0,0,0, henry_payroll[[6]],0,0,minhchau_payroll[[6]])))
data.frame(c(0,2019,0,0,0, henry_payroll[[6]],0,0,minhchau_payroll[[6]]))
henry_payroll[[6]]
henry_daverin <- rbind(henry_daverin, data.frame(c(0,2019,0,0,0, henry_payroll$total_pay[6],0,0,minhchau_payroll$total_pay[6])))
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = minhchau_total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
henry_daverin <- data.frame(henry_daverin)
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = minhchau_total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
henry_daverin <- police[police$unique_mos_id == 11185,]
henry_payroll <- payroll %>%
filter(Last.Name == "DAVERIN" | Last.Name == "Daverin") %>%
filter(First.Name == "HENRY") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay)
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(Fiscal.Year)
henry_payroll <- henry_payroll %>%
rename(year_received = Fiscal.Year) %>%
select(year_received, total_pay) %>%
arrange(year_received)
henry_daverin <- henry_daverin %>%
group_by(month_received, year_received, fado_type) %>%
count() %>%
pivot_wider(names_from = fado_type, values_from = n) %>%
rename(abuse = `Abuse of Authority`,
rude = Discourtesy,
force = Force) %>%
mutate_at(c("abuse","rude","force"), ~replace(., is.na(.), 0)) %>%
inner_join(henry_payroll, by = 'year_received') %>%
mutate(adjusted_pay = henry_payroll$total_pay[year_received - 2013] +
(month_received-1)/12 * (henry_payroll$total_pay[year_received - 2012] - henry_payroll$total_pay[year_received - 2013])) %>%
mutate(allegations = abuse + rude + force)
henry_daverin$minhchau_total_pay <- 0
for (i in 1:nrow(henry_daverin)){
year <- henry_daverin$year_received[i] - 2013
henry_daverin$minhchau_total_pay[i] <- minhchau_payroll$total_pay[year]
}
henry_daverin <- rbind(henry_daverin, data.frame(c(1,2019,0,0,0, henry_payroll$total_pay[6],0,0,minhchau_payroll$total_pay[6])))
henry_daverin <- data.frame(henry_daverin)
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue') +
geom_line(aes(x = year_received, y = minhchau_total_pay)) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g
henry_daverin <- police[police$unique_mos_id == 11185,]
henry_payroll <- payroll %>%
filter(Last.Name == "DAVERIN" | Last.Name == "Daverin") %>%
filter(First.Name == "HENRY") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay)
# same rank, same precinct, no allegations
minhchau_payroll <- payroll %>% filter(Last.Name == "HONG") %>%
filter(First.Name == "MINH CHAU") %>%
mutate(total_pay = Regular.Gross.Paid + Total.OT.Paid + Total.Other.Pay) %>%
arrange(Fiscal.Year)
henry_payroll <- henry_payroll %>%
rename(year_received = Fiscal.Year) %>%
select(year_received, total_pay) %>%
arrange(year_received)
henry_daverin <- henry_daverin %>%
group_by(month_received, year_received, fado_type) %>%
count() %>%
pivot_wider(names_from = fado_type, values_from = n) %>%
rename(abuse = `Abuse of Authority`,
rude = Discourtesy,
force = Force) %>%
mutate_at(c("abuse","rude","force"), ~replace(., is.na(.), 0)) %>%
inner_join(henry_payroll, by = 'year_received') %>%
mutate(adjusted_pay = henry_payroll$total_pay[year_received - 2013] +
(month_received-1)/12 * (henry_payroll$total_pay[year_received - 2012] - henry_payroll$total_pay[year_received - 2013])) %>%
mutate(allegations = abuse + rude + force)
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations)) +
geom_line(aes(x = year_received, y = total_pay), color = 'blue')
g
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue')
g
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations))
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = minhchau_total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations), alpha = 0.5, color = 'red') +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations))
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = allegations)) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two similar officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two same-rank officers' payroll histories")
ggplotly(g, tooltip = "text")
saveWidget(as_widget(ggplotly(g, tooltip = "text")), "payroll.html")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Allegations.", "\n\n",
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two same-rank officers' payroll histories")
saveWidget(as_widget(ggplotly(g, tooltip = "text")), "payroll.html")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Allegations", "\n",
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two same-rank officers' payroll histories")
ggplotly(g, tooltip = "text")
g <- ggplot(data=henry_daverin, aes(x = year_received + (month_received-1)/12, y = adjusted_pay, text = paste0(
"Allegations of...", "\n",
"Force: ", force, "\n",
"Abuse of Authority: ", abuse, "\n",
"Discourtesy: ", rude
))) +
geom_point(aes(x = year_received + (month_received-1)/12, y = adjusted_pay, size = allegations), alpha = 0.5, color = 'red')
g <- g + geom_line(data = henry_payroll, aes(x = year_received, y = total_pay), color = 'blue', inherit.aes = FALSE)
g <- g + geom_line(data = minhchau_payroll, aes(x = Fiscal.Year, y = total_pay), inherit.aes = FALSE) +
xlab("Year") + ylab("Total Pay") +
ggtitle("Two same-rank officers' payroll histories")
ggplotly(g, tooltip = "text")
saveWidget(as_widget(ggplotly(g, tooltip = "text")), "payroll.html")
henry_daverin
sum(henry_daverin$allegations)
